(function(){function h(){this.setup()}var f=facilis.extend(h,{});f.setup=function(){this.workflowProcessObj=this.mainWorkflowProcessId=this.workflowProcessName=this.toParseXML=this.parsedModel=null;this.processAction=""};h.performers=[];h.artifacts=[];h.datastores=[];f.parse=function(a){h.performers=[];h.artifacts=[];h.datastores=[];this.workflowProcessName="";toParseXML=a;if(!a.firstElementChild)return null;a=a.firstElementChild;this.associations=[];this.messageFlows=[];var b;for(b=0;b<a.children.length;b++)if(a.children[b].localName==
"DataStores"){h.datastores=this.parseDataStores(a.children[b]);break}for(b=0;b<a.children.length;b++){a.children[b].localName=="Pools"&&this.parsePools(a.children[b]);if(a.children[b].localName=="Artifacts")h.artifacts=this.parseArtifacts(a.children[b]);if(a.children[b].localName=="Associations")this.associations=this.parseAssociations(a.children[b]);if(a.children[b].localName=="MessageFlows")this.messageFlows=this.parseMessageFlows(a.children[b]);if(a.children[b].localName=="Participants")for(var c=
a.children[b],d=0;d<c.children.length;d++){var e=c.children[d];h.addParticipant(e.getAttribute("Id"),e.getAttribute("Name"))}}if(h.artifacts)for(b=0;b<h.artifacts.length;b++)if(facilis.View.importDisconnectedArtifacts||!facilis.View.importDisconnectedArtifacts&&this.artifactHasValidAssociation(h.artifacts[b],this.associations))this.parsedModel.subElements.push(h.artifacts[b]);if(this.associations)for(b=0;b<this.associations.length;b++)this.parsedModel.subElements.push(this.associations[b]);if(this.messageFlows)for(b=
0;b<this.messageFlows.length;b++)this.parsedModel.subElements.push(this.messageFlows[b]);return this.parsedModel};f.artifactHasValidAssociation=function(a,b){if(b&&facilis.getClassName(a).toLowerCase()=="dataobject")for(var c=0;c<b.length;c++){var d=b[c];if(d.startid==a.id||d.endid==a.id)return true}else if(facilis.getClassName(a).toLowerCase()!="dataobject")return true;return false};f.parsePools=function(a){var b=[],c,d,e=true,g,i=facilis.parsers.ParseInUtils.getParsedNode("<Pools></Pools>"),k;for(d=
0;d<a.children.length;d++){c=a.children[d].getAttribute("MainPool");if(c=="true"){g=a.children[d];e=false}}if(e){for(d=0;d<a.children.length;d++)if(a.children[d].getAttribute("BoundaryVisible")=="false"){g=a.children[d];break}g||(g=a.children[0]);g.setAttribute("MainPool","true")}else if(g.getAttribute("BoundaryVisible")=="true"){a=facilis.parsers.ParseInUtils.getParsedNode("<Pool></Pool>");k=g.cloneNode(true);a.setAttribute("MainPool","true");g.setAttribute("MainPool","false");k.setAttribute("Process",
"");i.appendChild(a);i.appendChild(k);a=i}else{c=facilis.parsers.ParseInUtils.getSubNode(toParseXML,"WorkflowProcesses");i=facilis.parsers.ParseInUtils.getSubNode(toParseXML,"Pools");d={};for(e=0;e<i.children.length;e++)d[i.children[e].getAttribute("Process")]=true;i="";for(e=0;e<c.children.length;e++){c.children[e].getAttribute("Id")==g.getAttribute("Process")&&c.children[e].getAttribute("Name")&&g.setAttribute("Name",c.children[e].getAttribute("Name"));var l;if(c.children[e].getAttribute("Name")&&
facilis.parsers.ParseInUtils.getSubNode(c.children[e],"Activities")){this.workflowProcessName=c.children[e].getAttribute("Name");k=null;for(l=0;l<c.children[e].children.length;l++)if(c.children[e].children[l].localName=="Object"){k=c.children[e];break}if(k)this.workflowProcessObj=k}if(this.workflowProcessName!="")break;if(c.children[e].getAttribute("Name")&&d[c.children[e].getAttribute("Name")]){i=c.children[e].getAttribute("Name");if(!k)for(l=0;l<c.children[e].children.length;l++)if(c.children[e].children[l].localName==
"Object"){k=c.children[e];break}if(k)this.workflowProcessObj=k}if(c.children[e].getAttribute("ProAction"))this.processAction=c.children[e].getAttribute("ProAction")}if(this.workflowProcessName==""&&i!="")this.workflowProcessName=i;g.getAttribute("Name")||g.setAttribute("Name",this.workflowProcessName);if(this.workflowProcessObj){k=this.removeWFNodes(this.workflowProcessObj);for(c=0;k.length>0;){g.appendChild(k[0]);k.splice(0,1);c++}}}c="false";for(d=0;d<a.children.length;d++){if(c=="false"){c=a.children[d].getAttribute("MainPool")+
"";if(c!="true")c=(a.children[d].getAttribute("BoundaryVisible")=="false").toString()}if(c=="true"){g=this.getElementParser("back");g.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel("back"))}else{g=this.getElementParser("pool");g.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel("pool"))}g=g.parse(a.children[d]);if(c=="true"){this.parsedModel=g;c="ready"}else b.push(g)}for(d=0;d<b.length;d++){this.parsedModel.subElements.push(b[d]);this.parseWorkflow(b[d])}if(b.length==
0)this.parseWorkflow(this.parsedModel);else{this.parseWorkflowProEvents(this.parsedModel);this.parseWorkflowProForms(this.parsedModel)}if(this.parsedModel){this.workflowProcessName&&facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel.firstElementChild,"name",this.workflowProcessName);this.processAction&&facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel.firstElementChild,"protype",this.processAction)}};f.removeWFNodes=function(a){var b=[],c=[],d={};d.ApiaProEvents=true;d.Object=
true;var e=0;for(e=0;e<a.children.length;e++)d[a.children[e].localName]&&b.push(a.children[e]);for(e=0;e<b.length;e++){c.push(b[e].cloneNode(true));b[e].parentNode.removeChild(b[e])}return c};f.parseWorkflow=function(a){for(var b=facilis.parsers.ParseInUtils.getSubNode(toParseXML,"WorkflowProcesses"),c,d=0;d<b.children.length;d++)if(b.children[d].getAttribute("Id")==a.process){c=b.children[d];break}if(c){b=new facilis.parsers.input.WorkflowProcess;b.setParsedModel(a);b.parse(c);this.parseSubElements(c,
a)}};f.parseWorkflowProForms=function(a){for(var b=facilis.parsers.ParseInUtils.getSubNode(toParseXML,"WorkflowProcesses"),c=0;c<b.children.length;c++){var d=new facilis.parsers.input.WorkflowProcess;d.setParsedModel(a);d.toParseNode=b.children[c];d.getDocumentation()}};f.parseWorkflowProEvents=function(a){for(var b=facilis.parsers.ParseInUtils.getSubNode(toParseXML,"WorkflowProcesses"),c=null,d=0;d<b.children.length&&c==null;d++)for(var e=b.children[d],g=0;g<e.children.length&&c==null;g++)if(e.children[g].localName==
"ApiaProEvents")c=e.children[g];if(c){b=new WorkflowProcess;b.setParsedModel(a);b.parseLaneEvents(c)}};f.parseSubElements=function(a,b){if(a&&b){b.activitySets=[];var c=0;for(c=0;c<a.children.length;c++){if(a.children[c].localName=="Activities")b.subElements=b.subElements.concat(this.parseActivities(a.children[c]));if(a.children[c].localName=="Transitions")b.subElements=b.subElements.concat(this.parseTransitions(a.children[c]));if(a.children[c].localName=="ActivitySets")b.activitySets=b.activitySets.concat(this.parseActivitySets(a.children[c]));
if(a.children[c].localName=="DataInputOutputs")h.artifacts=h.artifacts.concat(this.parseDataInputOutputs(a.children[c]));if(a.children[c].localName=="DataStoreReferences")h.artifacts=h.artifacts.concat(this.parseDataStoreReferences(a.children[c]))}for(c=b.activitySets.length-1;c>=0;c--)for(var d=b.activitySets[c].id,e=0;e<b.subElements.length;e++)if(b.subElements[e].id==d)if(b.activitySets[c]){b.subElements[e].subElements.push(b.activitySets[c]);break}}};f.parseActivities=function(a){for(var b=[],
c=0;c<a.children.length;c++)if(a.children[c]){var d=this.getElementType(a.children[c]),e=this.getElementParser(d);e.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel(d));b.push(e.parse(a.children[c]))}return b};f.parseTransitions=function(a){for(var b=[],c=0;c<a.children.length;c++)if(a.children[c]){var d=this.getElementType(a.children[c]),e=this.getElementParser(d);e.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel(d));b.push(e.parse(a.children[c]))}return b};
f.parseActivitySets=function(a){for(var b=[],c=0;c<a.children.length;c++)a.children[c]&&b.push(this.parseActivitySet(a.children[c].getAttribute("Id"),a.children[c]));return b};f.parseActivitySet=function(a,b){var c={id:a,subElements:[]};this.parseSubElements(b,c);return c};f.parseDataStores=function(a){for(var b=[],c=0;c<a.children.length;c++){var d=a.children[c];if(d){var e=this.getElementType(d),g=this.getElementParser(e);g.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel(e));
d=g.parse(d);b.push(d)}}return b};f.parseArtifacts=function(a){for(var b=[],c=0;c<a.children.length;c++)if(a.children[c]){var d=this.getElementType(a.children[c]),e=this.getElementParser(d);e.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel(d));d=e.parse(a.children[c]);b.push(d)}return b};f.parseDataInputOutputs=function(a){for(var b=[],c=0;c<a.children.length;c++)if(a.children[c]){var d=this.getElementType(a.children[c]),e=this.getElementParser(d);e.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel(d));
d=e.parse(a.children[c]);b.push(d)}return b};f.parseDataStoreReferences=function(a){for(var b=[],c=0;c<a.children.length;c++)if(a.children[c]){var d=this.getElementType(a.children[c]),e=this.getElementParser(d);e.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel(d));d=e.parse(a.children[c]);a.children[c].getAttribute("DataStoreRef");e=a.children[c].getAttribute("State");if(d.state!=null)d.state=e;for(j=0;j<h.datastores.length;j++)if(h.datastores[j].id=="datastoreref"){e=
h.datastores[j];d.name=e.name;d.documentation=e.documentation;d.capacity=e.capacity;d.isUnlimited=e.isUnlimited;break}b.push(d)}return b};f.parseAssociations=function(a){for(var b=[],c=0;c<a.children.length;c++)if(a.children[c]){var d=this.getElementParser("association");d.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel("association"));d=d.parse(a.children[c]);b.push(d)}return b};f.parseMessageFlows=function(a){for(var b=[],c=0;c<a.children.length;c++)if(a.children[c]){var d=
this.getElementParser("mflow");d.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel("mflow"));d=d.parse(a.children[c]);b.push(d)}return b};f.getElementParser=function(a){var b="";switch(a){case "task":b="Task";break;case "csubflow":b="Subflow";break;case "esubflow":b="Subflow";break;case "startevent":b="Event";break;case "middleevent":b="Event";break;case "endevent":b="Event";break;case "gateway":b="Gateway";break;case "pool":b="Pool";break;case "group":b="Artifact";break;
case "swimlane":b="Lane";break;case "textannotation":b="Artifact";break;case "dataobject":case "datainput":case "dataoutput":b="Artifact";break;case "datastore":b="Artifact";break;case "back":b="Back";break;case "association":b="Association";break;case "mflow":b="Transition";break;case "sflow":b="Transition";break;case "activityset":b="ActivitySet"}return eval("new facilis.parsers.input."+b+"()")};f.getElementType=function(a){if(facilis.parsers.ParseInUtils.getSubNode(a,"Task"))return"task";else if(facilis.parsers.ParseInUtils.getSubNode(a,
"BPMNEvent")||facilis.parsers.ParseInUtils.getSubNode(a,"Event")){a=(facilis.parsers.ParseInUtils.getSubNode(a,"BPMNEvent")?facilis.parsers.ParseInUtils.getSubNode(a,"BPMNEvent"):facilis.parsers.ParseInUtils.getSubNode(a,"Event")).firstElementChild.localName;return a=="StartEvent"?"startevent":a=="IntermediateEvent"?"middleevent":"endevent"}else if(facilis.parsers.ParseInUtils.getSubNode(a,"Route")||facilis.parsers.ParseInUtils.getSubNode(a,"Gateway"))return"gateway";else if(facilis.parsers.ParseInUtils.getSubNode(a,
"BlockActivity")||facilis.parsers.ParseInUtils.getSubNode(a,"SubFlow"))return facilis.parsers.ParseInUtils.getSubNode(a,"NodeGraphicsInfo").getAttribute("Expanded")=="true"?"esubflow":"csubflow";else if(a.localName=="Transition")return"sflow";else if(a.localName=="DataInput")return"datainput";else if(a.localName=="DataOutput")return"dataoutput";else if(a.localName=="DataStore")return"datastore";else if(a.localName=="DataStoreReferences"||a.localName=="DataStoreReference"||a.localName=="DataStores"||
a.localName=="DataStore")return"datastore";else if(a.getAttribute("ArtifactType")){a=a.getAttribute("ArtifactType");return a=="DataObject"?"dataobject":a=="Group"?"group":"textannotation"}else if(facilis.parsers.ParseInUtils.getSubNode(a,"Implementation")){facilis.parsers.ParseInUtils.getSubNode(a,"Implementation");return"task"}else if(a.localName=="Lane")return"swimlane"};h.addParticipant=function(a,b){for(var c=0;c<h.performers.length;c++)if(h.performers[c].id==a)return;if(b==null||b=="")b=a;h.performers.push({id:a,
name:b})};h.getParticipantByName=function(a){for(var b=0;b<h.performers.length;b++)if(h.performers[b].name==a)return h.performers[b];return null};h.getParticipantById=function(a){for(var b=0;b<h.performers.length;b++)if(h.performers[b].id==a)return h.performers[b];return null};h.getParticipantByIdOrName=function(a){for(var b=0;b<h.performers.length;b++){if(h.performers[b].id==a)return h.performers[b];if(h.performers[b].name==a)return h.performers[b]}return null};facilis.parsers.ParserIn=facilis.promote(h,
"Object");facilis.parsers.ParseInUtils={};facilis.parsers.ParseInUtils.getParsedNode=function(a){return(new window.DOMParser).parseFromString(a,"text/xml").firstElementChild};facilis.parsers.ParseInUtils.getSubNodeValue=function(a,b){var c=getSubNode(a,b);if(c&&c.setAttribute("value","")!=undefined&&c.getAttribute("value")!="undefined")return c.getAttribute("value");return null};facilis.parsers.ParseInUtils.setSubNodeValue=function(a,b,c){if(c)(a=facilis.parsers.ParseInUtils.getSubNode(a,b))&&a.setAttribute("value",
c)};facilis.parsers.ParseInUtils.getSubNode=function(a,b){b=b||"";if(a&&a.children){for(var c=0;c<a.children.length;c++)if((a.children[c].getAttribute("name")||"").toLowerCase()==b.toLowerCase()||(a.children[c].nodeName||"").toLowerCase()==b.toLowerCase()||(a.children[c].localName||"").toLowerCase()==b.toLowerCase())return a.children[c];for(c=0;c<a.children.length;c++){var d=facilis.parsers.ParseInUtils.getSubNode(a.children[c],b);if(d)return d}}return null}})();
(function(){function h(){this.toParseNode=this.parsedModel=null;this.parseFunctions=[];this.parseFunctions.push(this.getId);this.parseFunctions.push(this.getName);this.parseFunctions.push(this.getDocumentation);this.parseFunctions.push(this.parseCategories);this.parseFunctions.push(this.parseDataFields);this.parseFunctions.push(this.parseUserAttributes);this.parseFunctions.push(this.getNodeGraphicsInfo)}var f=facilis.extend(h,{});f.getNodeGraphicsInfo=function(){var a=this.getToParseSubNode("NodeGraphicsInfos");
if(a&&a.firstElementChild){a=a.firstElementChild;this.parseNodeGraphicsInfo(a)}else(a=this.getToParseSubNode("NodeGraphicsInfo"))&&this.parseNodeGraphicsInfo(a)};f.parseNodeGraphicsInfo=function(a){var b=a.getAttribute("Width"),c=a.getAttribute("Height"),d=0,e=0;if(a.firstElementChild){d=a.firstElementChild.getAttribute("XCoordinate");e=a.firstElementChild.getAttribute("YCoordinate")}this.parsedModel.x=d?d:"0";this.parsedModel.y=e?e:"0";this.parsedModel.width=b?b:"0";this.parsedModel.height=c?c:"0";
if(b=a.getAttribute("Shape"))this.parsedModel.shape=b;this.getColor(a)};f.getColor=function(a){if((a=a.getAttribute("FillColor"))&&this.parsedModel.colorFill)this.parsedModel.colorFill=a};f.getName=function(){var a=this.toParseNode.getAttribute("Name")||"";if(this.parsedModel&&a!=null){if(this.parsedModel.nameChooser!=null)this.parsedModel.nameChooser=a;if(this.parsedModel.name!=null)this.parsedModel.name=a}};f.getId=function(){var a=this.toParseNode.getAttribute("Id");if(a!=null)this.parsedModel.id=
a};f.parse=function(a){this.toParseNode=a;return this.startParse()};f.setParsedModel=function(a){this.parsedModel=a};f.getToParseSubNode=function(a,b){return facilis.parsers.ParseInUtils.getSubNode(b||this.toParseNode,a)};f.getParsedSubNode=function(a){console.log("FIX getParsedSubNode ATTRIBUTE "+a);return facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,a)};f.setParsedModelValue=function(a,b){if(this.parsedModel[a]&&b)this.parsedModel[a]=b};f.getToParseSubNodeValue=function(a){return facilis.parsers.ParseInUtils.getSubNodeValue(this.toParseNode,
a)};f.getParsedSubNodeValue=function(a){console.log("FIX getParsedSubNodeValue ATTRIBUTE "+a);return facilis.parsers.ParseInUtils.getSubNodeValue(this.parsedModel,a)};f.callParseFunctions=function(){for(var a=0;a<this.parseFunctions.length;a++)this.parseFunctions[a].apply(this)};f.startParse=function(){this.callParseFunctions();return this.parsedModel};f.getParsedNode=function(a){return facilis.parsers.ParseInUtils.getParsedNode(a)};f.getData=function(a){return facilis.parsers.ParseInUtils.getSubNode(a,
"data")};f.getDocumentation=function(){for(var a,b=0;b<this.toParseNode.children.length;b++)if(this.toParseNode.children[b].localName=="Object")a=this.toParseNode.children[b];var c;if(a)c=facilis.parsers.ParseInUtils.getSubNode(a,"Documentation");if(!c)for(b=0;b<this.toParseNode.children.length;b++)if(this.toParseNode.children[b].localName=="Documentation"){c=this.toParseNode.children[b];break}if(c)this.parsedModel.forms!=null||this.parsedModel.events!=null||this.parsedModel.title!=null?this.parseAdvancedDocumentation(c):
this.parseDocumentationNode(c)};f.parseDocumentationNode=function(a){if(this.parsedModel.documentation!=null&&a&&a.firstChild){var b=a.firstChild.textContent;if(b.indexOf("&lt;forms")>=0||b.indexOf("&lt;events")>=0||b.indexOf("&lt;documentation")>=0||b.indexOf("&lt;title")>=0||b.indexOf("<forms")>=0||b.indexOf("<events")>=0||b.indexOf("<documentation")>=0||b.indexOf("<title")>=0){a=facilis.parsers.ParseInUtils.getParsedNode("<aux>"+b+"</aux>");for(b=0;b<a.children.length;b++){var c=a.children[b].cloneNode(true);
if(c.nodeName=="documentation"){this.parsedModel.documentation=c.textContent;break}}}else if(a.firstChild&&a.textContent)if(a=a.firstChild.textContent)this.parsedModel.documentation=a}};f.parseAdvancedDocumentation=function(a){console.log("ARREGLAR LOS FORMS EVENTS ETC");if(a.firstChild){var b=a.firstChild.wholeText||a.firstChild.textContent,c,d,e,g,i=false;if(b.indexOf("&amp;lt;")>=0){b=b.split("&amp;lt;").join("&lt;");b=b.split("&amp;gt;").join("&gt;");b=b.split("&amp;quot;").join("&quot;");b=b.split("&amp;amp;").join("&amp;");
b=b.split(" = ").join("=");a.firstChild.nodeValue=b;i=true}if(b.indexOf("&lt;forms")>=0||b.indexOf("&lt;events")>=0||b.indexOf("&lt;documentation")>=0||b.indexOf("&lt;title")>=0){b=b.split("&lt;events&gt;").join("<events>");b=b.split("&lt;forms&gt;").join("<forms>");b=b.split("&lt;documentation&gt;").join("<documentation>");b=b.split("&lt;title&gt;").join("<title>");b=b.split("&lt;event").join("<event");b=b.split("&lt;form").join("<form");b=b.split("&lt;attribute").join("<attribute");if(b.indexOf("<documentation>")>=
0){b=b.split("<documentation>");var k,l;if(b.length>1){b[0]=b[0].split("&quot;").join('"');b[0]=b[0].split("&amp;").join("&");k=b[1].split("</documentation>");l=b[0]}else k=b[0].split("</documentation>");l+=i?"<documentation>"+k[0]:"<documentation>"+k[0].split("&amp;quot;").join("&quot;").split("&amp;gt;").join("&gt;");l+="</documentation>";if(k.length>1){k[1]=k[1].split("&quot;").join('"');k[1]=k[1].split("&amp;").join("&");l+=k[1]}b=l}else{b=b.split("&quot;").join('"');b=b.split("&amp;").join("&")}b=
b.split("&lt;/events&gt;").join("</events>");b=b.split("&lt;/forms&gt;").join("</forms>");b=b.split("&lt;/documentation&gt;").join("</documentation>");b=b.split("&lt;/title&gt;").join("</title>");b=b.split("&lt;/event").join("</event");b=b.split("&lt;/form").join("</form");b=b.split("&lt;/attribute").join("</attribute");b=b.split("&gt;").join(">");b=b.split("&quot;").join('"')}i=facilis.parsers.ParseInUtils.getParsedNode("<aux>"+b+"</aux>");for(l=0;l<i.children.length;l++){b=i.children[l].cloneNode(true);
if(b.nodeName=="documentation")c=b;if(b.nodeName=="forms")d=b;if(b.nodeName=="events")e=b;if(b.nodeName=="title")g=b}var m;if(c&&c.firstChild&&c.firstChild.textContent)m=c.firstChild.textContent;else if(!c)if(a.firstElementChild&&a.firstElementChild.nodeName!="forms"&&a.firstElementChild.nodeName!="events"&&a.firstElementChild.nodeName!="title"){console.log("CHEQUEAR DOCUMENTACION");m=c.outerHTML}if(m&&this.parsedModel.documentation!=null)this.parsedModel.documentation=m;if(d&&this.parsedModel.forms!=
null){a=this.getFormValues(d);if(this.parsedModel instanceof facilis.model.Back)for(c=0;c<a.length;c++){d=parseInt(a[c].formId);facilis.controller.FormResources.getInstance().addResource(a[c],d)}else this.parsedModel.forms=a}this.parsedModel.events=[];if(e)this.parsedModel.events=this.parseEventElements(e);if(g)this.parsedModel.title=g.getAttribute("value")}};f.getFormValues=function(a){console.log("VER EL PARSER DE STEPS");if(facilis.getClassName(this.parsedModel).toLowerCase()=="back")return this.getProcessForms(a);
var b=[],c={},d={order:0,pforms:[],eforms:[]};c["1"]=d;var e;if(a.firstElementChild&&!a.firstElementChild.nodeName)a=facilis.parsers.ParseInUtils.getParsedNode("<forms>"+a.firstElementChild.outerHTML+"</forms>");for(e=0;e<a.children.length;e++){var g=a.children[e];g.nodeName||(g=facilis.parsers.ParseInUtils.getParsedNode(g));if(g.frmStepId)if(c[formfrmStepId])d=c[g.frmStepId];else{d={order:parseInt(g.frmStepId),pforms:[],eforms:[]};c[g.frmStepId]=d}var i=e;if(g.frmOrder)i=parseInt(g.frmOrder);g.frmType==
"P"?d.pforms.push({order:i,form:g}):d.eforms.push({order:i,form:g})}a=[];for(var k in c)a.push(c[k]);a.sort(function(l,m){if(parseInt(l.order)==parseInt(m.order))return parseInt(l.frmOrder)-parseInt(m.frmOrder);return parseInt(l.order)-parseInt(m.order)});for(e=e=0;e<a.length;e++){c=[];k=[];d=a[e].eforms;d.sort(function(l,m){if(parseInt(l.order)==parseInt(m.order))return parseInt(l.frmOrder)-parseInt(m.frmOrder);return parseInt(l.order)-parseInt(m.order)});for(g=g=0;g<d.length;g++)(i=this.getFormValue(d[g].form))&&
c.push(i);d=a[e].pforms;d.sort(function(l,m){if(parseInt(l.order)==parseInt(m.order))return parseInt(l.frmOrder)-parseInt(m.frmOrder);return parseInt(l.order)-parseInt(m.order)});for(g=g=0;g<d.length;g++)(i=this.getFormValue(d[g].form))&&k.push(i);console.log("FIX STEP FORMS PARSER GET STEP REQUIRED");d={};d.stepformse=c;console.log("stepformse en ElementParser.as");d.entityforms=c;console.log("entityforms en ElementParser.as");console.log("stepformsp en ElementParser.as");d.stepformsp=k;console.log("stepformsp en ElementParser.as");
b.push(d)}return b};f.getProcessForms=function(a){for(var b=[],c=0;c<a.children.length;c++)b.push(this.getFormValue(a.children[c]));return b};f.getFormValue=function(a,b){if(!(a.getAttribute("name")=="undefined"&&a.getAttribute("description")=="undefined")){var c=new facilis.model.Form;c.formId=a.getAttribute("frmId")+""!="undefined"?a.getAttribute("frmId"):"";c.formName=a.getAttribute("frmName")+""!="undefined"?a.getAttribute("frmName"):"";c.formDesc=a.getAttribute("frmTitle")+""!="undefined"?a.getAttribute("frmTitle"):
"";if(c.formName==""&&a.getAttribute("name"))c.formName=a.getAttribute("name")+""!="undefined"?a.getAttribute("name"):"";if(c.formDesc==""&&a.attributes.description)c.formDesc=a.attributes.description+""!="undefined"?a.attributes.description:"";var d=facilis.parsers.ParseInUtils.getSubNode(a,"events");if(c.frmEvents!=null){c.frmEvents=[];if(d)frmEvents=this.parseEventElements(d)}if(c.doc!=null){c.doc=[];for(d=0;d<a.children.length;d++)if(a.children[d].nodeName=="attribute"||a.children[d].nodeName==
"documentation"){var e={};!a.children[d].getAttribute("attName")&&a.children[d].getAttribute("name")&&a.children[d].setAttribute("attName",a.children[d].getAttribute("name"));!a.children[d].getAttribute("attLabel")&&a.children[d].getAttribute("description")&&a.children[d].setAttribute("attLabel",a.children[d].getAttribute("description"));!a.children[d].getAttribute("regExp")&&a.children[d].getAttribute("rules")&&a.children[d].setAttribute("regExp",a.children[d].getAttribute("rules"));e.fname=a.children[d].getAttribute("attName");
e.description=a.children[d].getAttribute("attLabel");e.tooltip=a.children[d].getAttribute("attTooltip");e.datatype=a.children[d].getAttribute("datatype");e.fieldtype=this.getFieldType(a.children[d].getAttribute("fieldtype"));e.rules=a.children[d].getAttribute("regExp");e.grid=a.children[d].getAttribute("grid");c.doc.push(e)}}if(c.formId==""&&b){d=this.addFormResource(a);c.formId=d.resourceId}return c}return null};f.addFormResource=function(a){facilis.View.getInstance().getMainProcessData();var b=
a;if(b.formName)if(facilis.controller.FormResources.getInstance().checkExists(b.formName))b.resourceId=facilis.controller.FormResources.getInstance().getExistingId(b.formName);else b=facilis.controller.FormResources.getInstance().addResource(a);else b=facilis.controller.FormResources.getInstance().addResource(b);return b};f.getFieldType=function(a){var b="";switch(a){case "Radio":b="Radio Button";break;case "TextArea":b="Text Area";break;case "FileInput":b="File Input";break;case "Listbox":b="ListBox";
break;case "Checkbox":b="CheckBox";break;case "Combobox":b="ComboBox";break;default:b=a}b=="Input"||b=="ComboBox"||b=="ListBox"||b=="CheckBox"||b=="Radio Button"||b=="Text Area"||b=="File Input"||b=="Editor"||b=="Password"||(b="Input");return b};f.parseEventElements=function(a){var b=[];if(a.firstElementChild&&!a.firstElementChild.nodeName)a=facilis.parsers.ParseInUtils.getParsedNode("<events>"+a.firstElementChild.outerHTML+"</events>");for(var c=0;c<a.children.length;c++){var d=a.children[c];if(!(d.getAttribute("name")==
"undefined"&&d.getAttribute("description")=="undefined")){var e=new facilis.model.Event;!d.getAttribute("busClaName")&&d.getAttribute("action")&&d.setAttribute("busClaName",d.getAttribute("action"));!d.getAttribute("evtName")&&d.getAttribute("name")&&d.setAttribute("evtName",d.getAttribute("name"));e.evtName=d.getAttribute("evtName")!="undefined"?d.getAttribute("evtName"):"";e.clsName=d.getAttribute("busClaName")!="undefined"?d.getAttribute("busClaName"):"";e.clsDesc=d.getAttribute("busClaDesc")!=
"undefined"?d.getAttribute("busClaDesc"):"";b.push(e)}}return b};f.parseCategories=function(){var a=this.getToParseSubNode("Object");if((a=facilis.parsers.ParseInUtils.getSubNode(a,"Categories"))&&this.parsedModel.categories)this.parsedModel.categories=this.parseCategoriesNode(a)};f.parseCategoriesNode=function(a){this.parseSubCategories(a,values)};f.parseSubCategories=function(a){for(var b=[],c=0;c<a.children.length;c++){var d=this.getCategoryNode(a.children[c]);d&&b.push(d)}return b};f.getCategoryNode=
function(a){var b={};b.id=a.getAttribute("CategoryId");b.value=a.getAttribute("Name");b.type="label";if(a.children.length>0)b.subCategories=this.parseSubCategories(a);return b};f.parseProperties=function(){var a=this.getToParseSubNode("Properties");if(this.parsedModel.properties!=null)this.parsedModel.properties=this.parsePropertiesNode(a)};f.parsePropertiesNode=function(a){var b=[];if(a)for(var c=0;c<a.children.length;c++){var d=a.children[c],e={};e.name=d.getAttribute("Name");e.id=d.getAttribute("PropertyId");
e.propertytype=d.getAttribute("PropertyType");e.value=d.getAttribute("Type");e.type=d.getAttribute("Value");e.correlation=d.getAttribute("Correlation");e.uk=d.getAttribute("UK");e.multivalued=d.getAttribute("Multivalued");e.index=d.getAttribute("Index");b.push(e)}return b};f.parseDataFields=function(){var a=this.getToParseSubNode("DataFields");if(this.parsedModel.properties!=null)this.parsedModel.properties=this.parseDataFieldsNode(a)};f.parseDataFieldsNode=function(a){var b=[];if(a)for(var c=0;c<
a.children.length;c++){var d=a.children[c],e={};e.name=d.getAttribute("Name");e.value=d.getAttribute("Type");e.type=d.getAttribute("Value");e.correlation=d.getAttribute("Correlation");e.uk=d.getAttribute("UK");e.multivalued=d.getAttribute("Multivalued");e.index=d.getAttribute("Index");b.push(e)}return b};f.parseUserAttributes=function(){var a=this.getToParseSubNode("ExtendedAttributes");if(a)if(this.parsedModel.userproperties!=null)for(var b=0;b<a.children.length;b++){var c={};c.name=a.children[b].getAttribute("Name");
c.value=a.children[b].getAttribute("Value");c.type=a.children[b].getAttribute("Type");parsedModel.userproperties.push(c)}};f.getSubElements=function(){console.log("called element.getSubElements");return this.parsedModel.subElements};facilis.parsers.input.ElementParser=facilis.promote(h,"Object")})();
(function(){function h(){this.ElementParser_constructor();this.parseFunctions.push(this.getElementType);this.parseFunctions.push(this.parseAssignments);this.parseFunctions.push(this.parsePerformers);this.parseFunctions.push(this.parseProEleId)}var f=facilis.extend(h,facilis.parsers.input.ElementParser);f.startParse=function(){this.callParseFunctions();return this.parsedModel};f.getElementType=function(){var a=this.toParseNode.getAttribute("name");if(a=="gateway")this.parsedModel.ElementType="G";else if(a==
"task")this.parsedModel.ElementType="T";else if(a=="csubflow"||a=="esubflow")this.parsedModel.ElementType="S";else if(a=="startevent"||a=="middleevent"||a=="endevent")this.parsedModel.ElementType="E"};f.parseAssignments=function(){var a=this.getToParseSubNode("Assignments");if(this.parsedModel.assignments!=null)this.parsedModel.assignments=this.parseAssignmentsNode(a)};f.parseAssignmentsNode=function(a){var b=[];if(a)for(var c=0;c<a.children.length;c++)b.push(this.getAssignment(a.children[c]));return b};
f.getAssignment=function(a){console.log("FIX element.getAssignment");var b={},c=facilis.parsers.ParseInUtils.getSubNode(b,"from"),d=facilis.parsers.ParseInUtils.getSubNode(b,"to"),e=facilis.parsers.ParseInUtils.getSubNode(a,"Expression"),g=facilis.parsers.ParseInUtils.getSubNode(a,"Target");d=d.values;d.name=g.getAttribute("Name");d.type=g.getAttribute("Type");d.value=g.getAttribute("Value");d.correlation=g.getAttribute("Correlation");d.targettype=g.getAttribute("TargetType");d.index=g.getAttribute("Index");
e.firstElementChild&&facilis.parsers.ParseInUtils.setSubNodeValue(c,"expressionbody",e.firstElementChild.nodeValue);facilis.parsers.ParseInUtils.setSubNodeValue(b,"assigntime",a.getAttribute("AssignTime"));return b};f.parsePerformers=function(){var a=this.getToParseSubNode("Performers");if(!a){var b=this.getToParseSubNode("Performer");if(b){a=this.parsedModel.ownerDocument.createElement("Performers");a.appendChild(b)}}if(this.parsedModel.performers!=null)this.parsedModel.performers=this.parsePerformersNode(a)};
f.parsePerformersNode=function(a,b){if(this.parsedModel.performers&&!(this.parsedModel.performers instanceof Array)){if(a&&a.firstElementChild&&a.firstElementChild.firstElementChild)return a.firstElementChild.firstElementChild.nodeValue}else if(a){b=[];for(var c=0;c<a.children.length;c++){var d=a.children[c],e=d.getAttribute("PerfName"),g=d.getAttribute("PerfId");if(!g&&d.firstChild){g=d.firstChild.nodeValue;var i=facilis.parsers.ParserIn.getParticipantByIdOrName(g);if(i)g=i.id}if(!e)if(i=facilis.parsers.ParserIn.getParticipantById(g))e=
i.name;i=new facilis.model.Performer;i.id=g;i.name=e;if((g=facilis.parsers.ParseInUtils.getSubNode(d,"Documentation"))&&i.documentation)i.documentation=this.parseDocumentationNode(g);if(i.condition&&d.getAttribute("ProElePerfEvalCond"))i.condition=d.getAttribute("ProElePerfEvalCond");if(i.conditionDoc&&d.getAttribute("ConditionDoc"))i.conditionDoc=d.getAttribute("ConditionDoc");e!="busClass"&&b.push(i)}return b}};f.parseWebServiceCatchNode=function(a,b){this.parseCatchWs(a,b)};f.parseCatchWs=function(a,
b){a.firstElementChild&&this.parseWs(a.firstElementChild,b)};f.parseWs=function(a,b){var c=b.firstElementChild;c.children[0].value=a.getAttribute("ws_method_name");var d=c.children[1],e=this.parsedModel.ownerDocument.createElement("values");d.appendChild(e);c=c.children[2];var g=this.parsedModel.ownerDocument.createElement("values");c.appendChild(g);for(var i=0;i<a.children.length;i++){var k;if(a.children[i].getAttribute("attribute_type")=="E"){k=this.getData(c).cloneNode(true);g.appendChild(k)}else{k=
this.getData(d).cloneNode(true);e.appendChild(k)}k.nodeName="value";facilis.parsers.ParseInUtils.setSubNodeValue(k,"id",a.children[i].getAttribute("attribute_id"));facilis.parsers.ParseInUtils.setSubNodeValue(k,"name",a.children[i].getAttribute("name"));facilis.parsers.ParseInUtils.setSubNodeValue(k,"uk",(a.children[i].getAttribute("attribute_uk")=="T").toString());facilis.parsers.ParseInUtils.setSubNodeValue(k,"multivalued",(a.children[i].getAttribute("multivalued")=="T").toString())}};f.parseEvents=
function(a){var b=[];if(a)for(var c=0;c<a.children.length;c++)if(!a.children[c].getAttribute("WS")||a.children[c].getAttribute("WS")=="false"){var d=this.parseEventClass(a.children[c]);d&&b.push(d)}return b};f.parseEventClass=function(a){if(a.getAttribute("BusClaName")=="BPMNAutoComplete")return null;var b={};b.evtid=a.getAttribute("EvtId");b.clsid=a.getAttribute("BusClaId");b.evtname=a.getAttribute("EvtName");b.clsname=a.getAttribute("BusClaName");this.setSkipCondition(b,a.getAttribute("SkipCond"));
b.binding=this.parseBindings(facilis.parsers.ParseInUtils.getSubNode(a,"BusClaParBindings"));return b};f.setSkipCondition=function(a,b){a.skipcondition=b};f.parseBindings=function(a){var b=[];if(a)for(var c=0;c<a.children.length;c++){var d={};d.id=a.children[c].getAttribute("BusClaParId");d.param=a.children[c].getAttribute("BusClaParName");d.type=a.children[c].getAttribute("BusClaParType");d.value=a.children[c].getAttribute("BusClaParBndValue")?a.children[c].getAttribute("BusClaParBndValue"):"";d.attribute=
a.children[c].getAttribute("AttName")?a.children[c].getAttribute("AttName"):"";d.attributeid=a.children[c].getAttribute("AttId")?a.children[c].getAttribute("AttId"):"";d.attributetooltip=a.children[c].getAttribute("AttTooltip")?a.children[c].getAttribute("AttTooltip"):"";b.push(d)}return b};f.parseWebServiceThrowNode=function(a,b){this.parseThrowWs(b)};f.parseThrowWs=function(){var a=[],b=this.getToParseSubNode("ApiaEvents");if(b&&b.children.length>0)for(var c=0;c<b.children.length;c++){var d=this.parseWsEventClass(b.children[c]);
b.children[c].getAttribute("WS")&&b.children[c].getAttribute("WS")=="true"&&b.children[c].getAttribute("BusClaId")!="102"&&a.push(d)}return a};f.parseWsEventClass=function(a,b){b={evtname:"",evtid:"",clsname:"",clsid:"",binding:[]};b.evtid=a.getAttribute("EvtId");b.clsid=a.getAttribute("BusClaId");b.evtname=a.getAttribute("EvtName");b.clsname=a.getAttribute("BusClaName");b.binding=this.parseWsBindings(facilis.parsers.ParseInUtils.getSubNode(a,"BusClaParBindings"));return b};f.parseWsBindings=function(a){var b=
[];if(a)for(var c=0;c<a.children.length;c++){var d={id:"",param:"",type:"",value:"",attribute:"",attributeid:"",inout:"",attributetooltip:""};d.id=a.children[c].getAttribute("BusClaParId");d.param=a.children[c].getAttribute("BusClaParName");d.type=a.children[c].getAttribute("BusClaParType");d.value=a.children[c].getAttribute("BusClaParBndValue");d.attribute=a.children[c].getAttribute("AttName")?a.children[c].getAttribute("AttName"):"";d.attributeid=a.children[c].getAttribute("AttId")?a.children[c].getAttribute("AttId"):
"";d.uk=a.children[c].getAttribute("UK");d.multivalued=a.children[c].getAttribute("Multivalued");b.push(d)}return b};f.getWsPublications=function(){var a=this.getToParseSubNode("WsPublications");if(a){var b=this.getData(this.getParsedSubNode("webservices"));this.parsedModel.ownerDocument.createElement("values");if(b)for(var c=0;c<a.children.length;c++){var d=a.children[c],e=b.cloneNode(true);e.nodeName="value";facilis.parsers.ParseInUtils.getSubNode(e,"wsname").value=d.getAttribute("WsName");d=facilis.parsers.ParseInUtils.getSubNode(d,
"WsPublicationAttributes");var g=facilis.parsers.ParseInUtils.getSubNode(e,"entityattributes");e=facilis.parsers.ParseInUtils.getSubNode(e,"processattributes");if(d){var i=this.parsedModel.ownerDocument.createElement("values"),k=this.parsedModel.ownerDocument.createElement("values");g.appendChild(i);e.appendChild(k);g=this.getData(g);for(e=0;e<d.children.length;e++)parseWSAttribute(g,d.children[e])}}}};f.parseWSAttribute=function(a,b){a.cloneNode(true);if(b)for(var c=0;c<b.children.length;c++);};
f.parseProEleId=function(){var a=this.toParseNode.getAttribute("Id");if(a)this.parsedModel.proeleid=a};facilis.parsers.input.Activity=facilis.promote(h,"ElementParser")})();
(function(){function h(){this.Activity_constructor();this.parseFunctions.push(this.getLoopType)}facilis.extend(h,facilis.parsers.input.Activity).getLoopType=function(){var f=this.getToParseSubNode("Loop");if(f&&f.attributes.LoopType){var a=f.getAttribute("LoopType");if(this.parsedModel.looptype!=null)this.parsedModel.looptype=a;var b=f.firstElementChild;if(a=="Standard"){f=b.attributes.LoopMaximum;a=b.attributes.LoopCounter;this.setParsedModelValue("testTime",b.attributes.TestTime);this.setParsedModelValue("loopmaximum",
f);this.setParsedModelValue("loopcounter",a);this.setParsedModelValue("loopcondition",b.attributes.LoopCondition);this.setParsedModelValue("loopdocumentation",b.attributes.ConditionDoc)}else if(a=="MultiInstance")if((b=facilis.parsers.ParseInUtils.getSubNode(f,"LoopMultiInstance"))&&this.parsedModel.mi_condition!=null){if(b.attributes.MultiplierAttId)this.parsedModel.mi_condition={id:b.attributes.MultiplierAttId,name:b.attributes.MultiplierAttName};else b.getAttribute("MI_Condition")&&Utils.isNumeric(b.getAttribute("MI_Condition"))&&
this.setParsedModelValue("mi_condition",b.getAttribute("MI_Condition"));this.setParsedModelValue("mi_ordering",b.getAttribute("MI_Ordering"))}}};facilis.parsers.input.ActivityElement=facilis.promote(h,"Activity")})();
(function(){function h(){this.ElementParser_constructor();this.parseFunctions.push(this.getTextAnnotation);this.parseFunctions.push(this.getState);this.parseFunctions.push(this.getName);this.parseFunctions.push(this.getIsCollection);this.parseFunctions.push(this.getCapacity);this.parseFunctions.push(this.getIsUnlimited)}var f=facilis.extend(h,facilis.parsers.input.ElementParser);f.startParse=function(){this.callParseFunctions();return this.parsedModel};f.getTextAnnotation=function(){var a=this.toParseNode.getAttribute("TextAnnotation");
if(a)this.parsedModel.text=a};f.getName=function(){if(this.toParseNode.getAttribute("Name")){var a=this.toParseNode.getAttribute("Name");if(a!=null)this.parsedModel.name=a}};f.getState=function(){if(this.toParseNode.firstElementChild){var a=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"DataObject");if(a){a=a.getAttribute("State");if(a!=null)this.parsedModel.state=a}}};f.getIsCollection=function(){if(this.toParseNode.firstElementChild){var a;if(a=this.toParseNode.nodeName.indexOf("DataInput")>=
0?this.toParseNode:facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"DataObject")){a=a.getAttribute("IsCollection");if(a!=null)this.parsedModel.isCollection=a}}};f.getCapacity=function(){var a=this.toParseNode.getAttribute("Capacity");if(a)this.parsedModel.capacity=a};f.getIsUnlimited=function(){var a=this.toParseNode.getAttribute("IsUnlimited");if(a)this.parsedModel.isUnlimited=a};facilis.parsers.input.Artifact=facilis.promote(h,"ElementParser")})();
(function(){function h(){this.ElementParser_constructor();this.parseFunctions.push(this.getStartEnd);this.parseFunctions.push(this.getVertexes)}var f=facilis.extend(h,facilis.parsers.input.ElementParser);f.startParse=function(){this.callParseFunctions();return this.parsedModel};f.getStartEnd=function(){var a=this.toParseNode.getAttribute("From"),b=this.toParseNode.getAttribute("To");a||(a=this.toParseNode.getAttribute("Source"));b||(b=this.toParseNode.getAttribute("Target"));this.parsedModel.startid=
a;this.parsedModel.endid=b};f.getVertexes=function(){var a=this.getToParseSubNode("ConnectorGraphicsInfo");if(a){a=a.cloneNode(true);for(var b=[],c=0;c<a.children.length;c++)b.push({x:a.children[c].getAttribute("XCoordinate"),y:a.children[c].getAttribute("YCoordinate")});this.parsedModel.vertexes=b}};facilis.parsers.input.Line=facilis.promote(h,"ElementParser")})();
(function(){function h(){this.Line_constructor();this.parseFunctions.push(this.getDirection)}facilis.extend(h,facilis.parsers.input.Line).getDirection=function(){if(this.toParseNode.getAttribute("AssociationDirection")=="To"){this.toParseNode.attributes.AssociationDirection="From";var f=this.parsedModel.getAttribute("startid");this.parsedModel.startid=this.parsedModel.getAttribute("endid");this.parsedModel.endid=f}};facilis.parsers.input.Association=facilis.promote(h,"Line")})();
(function(){function h(){this.ElementParser_constructor()}facilis.extend(h,facilis.parsers.input.ElementParser);facilis.parsers.input.Lane=facilis.promote(h,"ElementParser")})();
(function(){function h(){this.ElementParser_constructor();this.parseFunctions.push(this.getRoute);this.parseFunctions.push(this.getInstantiate);this.parseFunctions.push(this.getExclusiveType);this.parseFunctions.push(this.getMarkerVisible);this.parseFunctions.push(this.getIncomingCondition);this.parseFunctions.push(this.getOutgoingCondition);this.parseFunctions.push(this.parseExecutionType)}var f=facilis.extend(h,facilis.parsers.input.ElementParser);f.getRoute=function(){(Route=this.getToParseSubNode("Route"))||
(Route=this.getToParseSubNode("Gateway"));if(Route){var a=Route.getAttribute("GatewayType");if(facilis.View.getInstance().offline){if(a=="AND")a="Parallel";if(a=="XOR")a="Exclusive";if(a=="OR")a="Inclusive"}if(a)this.parsedModel.gatewaytype=a}};f.getInstantiate=function(){if(Route&&Route.attributes.Instantiate)this.parsedModel.instantiate=(Route.getAttribute("Instantiate")||"false").toLowerCase()=="true"};f.getExclusiveType=function(){if(Route&&Route.getAttribute("ExclusiveType")&&this.parsedModel.exclusivetype)this.parsedModel.exclusivetype=
Route.getAttribute("ExclusiveType")};f.getMarkerVisible=function(){if(Route&&Route.getAttribute("MarkerVisible")&&this.parsedModel.markervisible)this.parsedModel.markervisible=Route.getAttribute("MarkerVisible")};f.getIncomingCondition=function(){if(Route&&Route.getAttribute("IncomingCondition")&&this.parsedModel.incomingcondition)this.parsedModel.incomingcondition=Route.getAttribute("IncomingCondition")};f.getOutgoingCondition=function(){if(Route&&Route.getAttribute("OutgoingCondition")&&this.parsedModel.outgoingcondition)this.parsedModel.outgoingcondition=
Route.getAttribute("OutgoingCondition")};f.parseExecutionType=function(){if(Route&&Route.getAttribute("ExecutionType")&&this.parsedModel.executiontype)this.parsedModel.executiontype=Route.getAttribute("ExecutionType")};facilis.parsers.input.Gateway=facilis.promote(h,"ElementParser")})();
(function(){function h(){this.Activity_constructor();this.parseFunctions.push(this.getProcess);this.parseFunctions.push(this.getBoundary);this.parseFunctions.push(this.getLanes);this.parseFunctions.push(this.parseParticipant)}var f=facilis.extend(h,facilis.parsers.input.Activity);f.getLanes=function(){if(this.toParseNode.attributes.BoundaryVisible!="false")for(var a=0;a<this.toParseNode.children.length;a++)this.toParseNode.children[a].localName=="Lanes"&&this.parseLanes(this.toParseNode.children[a])};
f.getProcess=function(){var a=this.toParseNode.getAttribute("Process");if(a!=null)this.parsedModel.process=a};f.getBoundary=function(){var a=this.toParseNode.getAttribute("BoundaryVisible")=="true";this.parsedModel.visible=a;this.parsedModel.boundaryvisible=a};f.parseLanes=function(a){for(var b=new facilis.parsers.ParserIn,c=0;c<a.children.length;c++){var d=b.getElementParser("swimlane");d.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel("swimlane"));d=d.parse(a.children[c]);
this.getSubElements().push(d)}};f.parseParticipant=function(){var a=this.getToParseSubNode("participantref");if(a&&this.toParseNode.attributes.Participant){(new facilis.model.Performer).name=this.toParseNode.getAttribute("Participant");a.appendChild(values);a.attributes.value=this.toParseNode.attributes.Participant}};facilis.parsers.input.Pool=facilis.promote(h,"Activity")})();
(function(){function h(){this.ActivityElement_constructor();this.parseFunctions.push(this.getImplementation);this.parseFunctions.push(this.getIsTransaction);this.parseFunctions.push(this.getBlockActivity);this.parseFunctions.push(this.getIsExpanded);this.parseFunctions.push(this.getExecution);this.parseFunctions.push(this.getDataMappings);this.parseFunctions.push(this.parseSkipFirstTask);this.parseFunctions.push(this.getPrcName);this.parseFunctions.push(this.getFormsRef);this.parseFunctions.push(this.getEntity)}
var f=facilis.extend(h,facilis.parsers.input.ActivityElement);f.getImplementation=function(){};f.getIsTransaction=function(){var a=this.toParseNode.getAttribute("IsATransaction");if(a!="false"){if(this.parsedModel.isATransaction!=null)this.parsedModel.isATransaction=a;if(a=this.getToParseSubNode("Transaction"))if(this.parsedModel.transactionid!=null)this.parsedModel.transactionid=a.getAttribute("Id")}};f.getIsAdhoc=function(){if(this.toParseNode.attributes.AdHoc.value!="false"){if(this.parsedModel.adhoc!=
null)this.parsedModel.adhoc=true;var a=this.getToParseSubNode("AdHocOrdering");if(a)if(this.parsedModel.adhocordering!=null)this.parsedModel.adhocordering=a}};f.getBlockActivity=function(){facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"BlockActivity")};f.getIsExpanded=function(){var a=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"NodeGraphicsInfo");if(a){var b=a.getAttribute("Expanded");if(b=="true"){this.parsedModel.expanded=b;if(a.getAttribute("ExpandedWidth")&&a.getAttribute("ExpandedHeight")){this.parsedModel.width=
a.getAttribute("ExpandedWidth");this.parsedModel.height=a.getAttribute("ExpandedHeight")}}}};f.getExecution=function(){var a=this.getToParseSubNode("SubFlow");if(a)if(a.getAttribute("ApiaExecution")=="MAP")this.setParsedModelValue("subprocesstype","Embedded");else{if(this.parsedModel.subprocesstype!=null)this.parsedModel.subprocesstype="Reusable";if((a=a.getAttribute("ApiaExecution"))&&a.indexOf("_SKIP")>0)a=a.split("_")[0];if(this.parsedModel.execution!=null)this.parsedModel.execution=a}};f.getDataMappings=
function(){var a=this.getToParseSubNode("DataMappings");if(a&&this.parsedModel.datamappings!=null){var b=facilis.parsers.ParseInUtils.getSubNode(datamappings,"inputmaps"),c=this.getData(b),d=this.parsedModel.ownerDocument.createElement("values");b.appendChild(d);var e=facilis.parsers.ParseInUtils.getSubNode(datamappings,"outputmaps");b=this.getData(e);var g=this.parsedModel.ownerDocument.createElement("values");e.appendChild(g);for(var i=0;i<a.children.length;i++){var k=a.children[i];if(k.attributes.Direction.value==
"IN"){e=c.cloneNode(true);e.nodeName="value";d.appendChild(e);facilis.parsers.ParseInUtils.setSubNodeValue(e,"inputmap",k.attributes.TestValue.value)}else{e=b.cloneNode(true);e.nodeName="value";g.appendChild(e);facilis.parsers.ParseInUtils.setSubNodeValue(e,"outputmap",k.attributes.TestValue.value)}}}};f.parseSkipFirstTask=function(){var a=this.getToParseSubNode("SubFlow");a&&facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,"skipfirsttask",a.getAttribute("SkipFirstTask"))};f.getPrcName=
function(){var a=this.getToParseSubNode("SubFlow");facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,"name",this.toParseNode.getAttribute("Name"));if(a){var b=a.getAttribute("Name");b.indexOf(".xpdl")>0&&facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,"filename",b);if(b=facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"name")){var c=facilis.parsers.ParseInUtils.getSubNode(b,"values");c&&c.removeNode();c=this.parsedModel.ownerDocument.createElement("values");c.setAttribute("value",
this.toParseNode.getAttribute("Name"));a=facilis.parsers.ParseInUtils.getParsedNode('<value value="'+this.toParseNode.getAttribute("Name")+'"><level name="id" type="label" value="'+a.attributes.Id.value+'" /><level name="name" type="label" value="'+this.toParseNode.getAttribute("Name")+'" /></value>');c.appendChild(a);b.attributes.value.value=this.toParseNode.getAttribute("Name");b.appendChild(c)}}};f.getEntity=function(){var a=this.getToParseSubNode("SubFlow");if(a){var b=facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,
"entity");if(b&&a.attributes.ProEleAttBusEntName.value&&a.attributes.ProEleAttBusEntId.value){var c=this.parsedModel.ownerDocument.createElement("values"),d=facilis.parsers.ParseInUtils.getParsedNode('<value value="'+a.attributes.ProEleAttBusEntName.value+'"><level name="id" type="label" value="'+a.attributes.ProEleAttBusEntId.value+'" /><level name="name" type="label" value="'+a.attributes.ProEleAttBusEntName.value+'" /></value>');c.appendChild(d);b.setAttribute("value",a.attributes.ProEleAttBusEntName.value);
b.appendChild(c)}}};f.getFormsRef=function(){if(this.parsedModel.processforms!=null&&this.parsedModel.entityforms!=null){var a=this.getToParseSubNode("FormsRef");this.parsedModel.processforms=[];this.parsedModel.entityforms=[];var b=[],c=[],d;if(a){for(var e=0;e<a.children.length;e++)if(a.children[e].attributes.FrmType.value=="E"){d=parseInt(a.children[e].attributes.ProEleFrmOrder.value);var g=this.parseFormRef(a.children[e]);b.push({order:d,data:g})}else{d=parseInt(a.children[e].attributes.ProEleFrmOrder.value);
g=this.parseFormRef(a.children[e]);c.push({order:d,data:g})}b.sort(function(i,k){return i.order<k.order});c.sort(function(i,k){return i.order<k.order});for(a=0;a<b.length;a++)this.parsedModel.entityforms.push(b[a].data);for(b=0;b<c.length;b++)this.parsedModel.processforms.push(c[b].data)}}};f.parseFormRef=function(a){var b={};b.id=a.getAttribute("FrmId");b.name=a.getAttribute("FrmName");b.readonly=a.getAttribute("ProEleFrmReadOnly");b.multiple=a.getAttribute("ProEleFrmMultiply");b.condition=a.getAttribute("ProEleFrmEvalCond");
b.documentation=a.getAttribute("ConditionDoc");return b};facilis.parsers.input.Subflow=facilis.promote(h,"ActivityElement")})();
(function(){function h(){this.Activity_constructor();this.parseFunctions.push(this.getProcess);this.parseFunctions.push(this.getBoundary);this.parseFunctions.push(this.getLanes);this.parseFunctions.push(this.parseBack);this.parseFunctions.push(this.getProcesClasses)}var f=facilis.extend(h,facilis.parsers.input.Activity);f.getLanes=function(){for(var a=0;a<this.toParseNode.children.length;a++)this.toParseNode.children[a].nodeName=="Lanes"&&this.parseLanes(this.toParseNode.children[a])};f.getProcess=
function(){var a=this.toParseNode.getAttribute("Process");if(a!=null)this.parsedModel.process=a};f.getBoundary=function(){var a=this.toParseNode.attributes.BoundaryVisible;this.parsedModel.boundaryvisible=a!=null?a:true};f.parseLanes=function(a){for(var b=new facilis.parsers.ParserIn,c=0;c<a.children.length;c++){var d=b.getElementParser("swimlane");d.setParsedModel(facilis.ElementAttributeController.getInstance().getElementModel("swimlane"));d=d.parse(a.children[c]);this.getSubElements().appendChild(d)}};
f.parseBack=function(){if(this.toParseNode&&this.toParseNode.parentNode&&this.toParseNode.parentNode.parentNode){var a=this.toParseNode.parentNode.parentNode,b=facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"bpd");if(b){facilis.parsers.ParseInUtils.setSubNodeValue(b,"id",a.attributes.Id.value);facilis.parsers.ParseInUtils.setSubNodeValue(b,"name",a.attributes.Name.value);facilis.parsers.ParseInUtils.setSubNodeValue(b,"language",a.attributes.Language.value);var c=facilis.parsers.ParseInUtils.getSubNode(a,
"RedefinableHeader");if(c){facilis.parsers.ParseInUtils.setSubNodeValue(b,"version",c.attributes.Version.value);facilis.parsers.ParseInUtils.setSubNodeValue(b,"author",c.attributes.Author.value)}(c=facilis.parsers.ParseInUtils.getSubNode(a,"Created"))&&facilis.parsers.ParseInUtils.setSubNodeValue(b,"creationdate",c.attributes.CreationDate.value);(c=facilis.parsers.ParseInUtils.getSubNode(a,"ModificationDate"))&&facilis.parsers.ParseInUtils.setSubNodeValue(b,"modificationdate",c.attributes.Date.value)}if(c=
facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"process")){facilis.parsers.ParseInUtils.getSubNodeValue(c,"processtype");b=facilis.parsers.ParseInUtils.getSubNode(c,"properties");facilis.parsers.ParseInUtils.setSubNodeValue(c,"processtype",a.attributes.ProcessType.value);(c=facilis.parsers.ParseInUtils.getSubNode(a,"Performers"))&&this.parsePerformers(c);(a=facilis.parsers.ParseInUtils.getSubNode(a,"Properties"))&&parsePropertiesNode(a,b)}}};f.parsePerformers=function(a){if(a)for(var b=
0;b<a.children.length;b++){var c=new facilis.model.Perfomer;c.id=Performer.attributes.PerfId;c.name=Performer.attributes.PerfName;if(c.condition)c.condition=Performer.getAttribute("ProElePerfEvalCond");this.parsedModel.performers!=null&&this.parsedModel.performers.push(c)}};f.getProcesClasses=function(){var a=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"ApiaProEvents");if(a&&this.parsedModel.bussinessclasses!=null)this.parsedModel.bussinessclasses=this.parseEvents(a)};facilis.parsers.input.Back=
facilis.promote(h,"Activity")})();
(function(){function h(){this.Activity_constructor();this.parseFunctions.push(this.getAttached);this.parseFunctions.push(this.getEvent);this.parseFunctions.push(this.getTrigger);this.parseFunctions.push(this.getTriggerElement)}var f=facilis.extend(h,facilis.parsers.input.Activity);f.getEvent=function(){this.toParseNode.getAttribute("name");var a=(this.getToParseSubNode("BPMNEvent")?this.getToParseSubNode("BPMNEvent"):this.getToParseSubNode("Event")).firstElementChild.localName;this.parsedModel.eventType=
a=="StartEvent"?"startevent":a=="IntermediateEvent"?"middleevent":"endevent"};f.getTrigger=function(){var a=this.getToParseSubNode("BPMNEvent")?this.getToParseSubNode("BPMNEvent"):this.getToParseSubNode("Event"),b=a.firstElementChild.getAttribute("Trigger")?a.firstElementChild.getAttribute("Trigger"):"";if(a.firstElementChild.getAttribute("Result"))b=a.firstElementChild.getAttribute("Result");if(this.parsedModel.eventdetailtype!=null)this.parsedModel.eventdetailtype=b};f.getTriggerElement=function(){var a=
facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"TriggerMultiple"),b=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"TriggerResultMessage"),c=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"TriggerTimer"),d=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"TriggerConditional"),e=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"TriggerResultSignal"),g=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"ResultError"),i=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,
"TriggerResultCompensation");if(a)this.parseMultipleTrigger(a,facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"multiple"));else if(b)this.parseMessageTrigger(b,facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"message"));else if(c)this.parseTimerTrigger(c,facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"timer"));else if(d)this.parseConditionalTrigger(d,facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"conditional"));else if(e)this.parseConditionalTrigger(e,facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,
"signal"));else if(g)this.parseErrorTrigger(g,facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"error"));else i&&this.parseCompensationTrigger(i,facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"compensation"))};f.getAttached=function(){var a=this.getToParseSubNode("IntermediateEvent");if(a&&(a.getAttribute("IsAttached")=="true"||a.getAttribute("Target"))){this.parsedModel.target=a.getAttribute("Target");this.parsedModel.isattached=true}else if(a)this.parsedModel.isattached=false};
f.parseMessageTrigger=function(a,b){var c;if(a){facilis.parsers.ParseInUtils.setSubNodeValue(b,"name",a.getAttribute("Name"));facilis.parsers.ParseInUtils.setSubNodeValue(b,"implementation",this.toParseNode.getAttribute("Implementation"));if(b&&this.parsedModel.getAttribute("name")=="middleevent"){b.setAttribute("disabled","false");var d=facilis.parsers.ParseInUtils.getSubNode(b,"outmessageref"),e=facilis.parsers.ParseInUtils.getSubNode(b,"inmessageref");if(c=facilis.parsers.ParseInUtils.getSubNode(a,
"WebServiceMapping")){d&&d.setAttribute("disabled","true");parseWebServiceCatchNode(c,e);facilis.parsers.ParseInUtils.setSubNodeValue(b,"catchthrow","CATCH")}else{e&&e.setAttribute("disabled","true");facilis.parsers.ParseInUtils.setSubNodeValue(b,"catchthrow","THROW");parseWebServiceThrowNode(null,d)}a.getAttribute("CatchThrow")&&facilis.parsers.ParseInUtils.setSubNodeValue(b,"catchthrow",(a.getAttribute("CatchThrow")+"").toUpperCase())}else if(!b&&this.parsedModel.getAttribute("name")=="middleevent")facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,
"catchthrow",(a.getAttribute("CatchThrow")+"").toUpperCase());else if(this.parsedModel.getAttribute("name")=="endevent"){facilis.parsers.ParseInUtils.getSubNode(a,"WebServiceThrow");parseWebServiceThrowNode(null,b)}else(c=facilis.parsers.ParseInUtils.getSubNode(a,"WebServiceMapping"))&&parseWebServiceCatchNode(c,b)}};f.parseTimerTrigger=function(a,b){if(a){var c=a.getAttribute("TimeDate"),d=a.getAttribute("EndDate");facilis.parsers.ParseInUtils.setSubNodeValue(b,"initdate",c);facilis.parsers.ParseInUtils.setSubNodeValue(b,
"enddate",d);if((c=facilis.parsers.ParseInUtils.getSubNode(b,"timerattribute"))&&c.firstElementChild&&c.firstElementChild.firstElementChild){c.firstElementChild.firstElementChild.setAttribute("value",a.getAttribute("TimerAttName"));facilis.parsers.ParseInUtils.setSubNodeValue(c,"name",a.getAttribute("TimerAttName"));facilis.parsers.ParseInUtils.setSubNodeValue(c,"id",a.getAttribute("TimerAttId"));c.setAttribute("value",a.getAttribute("TimerAttName"));facilis.parsers.ParseInUtils.setSubNodeValue(b,
"timerattributetype",a.getAttribute("TimerAttType"))}facilis.parsers.ParseInUtils.setSubNodeValue(b,"value",a.getAttribute("TimeCycle"));facilis.parsers.ParseInUtils.setSubNodeValue(b,"unit",a.getAttribute("TimeUnit"))}};f.parseConditionalTrigger=function(a,b){if(a){facilis.parsers.ParseInUtils.setSubNodeValue(b,"name",a.getAttribute("Name"));var c=facilis.parsers.ParseInUtils.getSubNode(a,"Expression");c&&facilis.parsers.ParseInUtils.setSubNodeValue(b,"expressionbody",c.firstElementChild.nodeValue)}};
f.parseSignalTrigger=function(a,b){a&&facilis.parsers.ParseInUtils.setSubNodeValue(b,"name",a.getAttribute("Name"))};f.parseMultipleTrigger=function(a,b){var c=facilis.parsers.ParseInUtils.getSubNode(b,"multimessage"),d=facilis.parsers.ParseInUtils.getSubNode(b,"multitimer");if(a)for(var e=0;e<a.children.length;e++)if(a.children[e].nodeName=="TriggerResultMessage")parseMessageTrigger(a.children[e],c);else a.children[e].nodeName=="TriggerTimer"&&parseTimerTrigger(a.children[e],d)};f.parseErrorTrigger=
function(a,b){a&&facilis.parsers.ParseInUtils.setSubNodeValue(b,"errorcode",a.getAttribute("ErrorCode"))};f.parseCompensationTrigger=function(a,b){if(a){var c=a.getAttribute("ActivityType");facilis.parsers.ParseInUtils.setSubNodeValue(b,"activitytype",c);c=="Task"?facilis.parsers.ParseInUtils.setSubNodeValue(b,"activityreftask",a.getAttribute("ActivityId")):facilis.parsers.ParseInUtils.setSubNodeValue(b,"activityrefsubproc",a.getAttribute("ActivityId"))}};f.parseMultiCompensationTrigger=function(a,
b){if(a){b=facilis.parsers.ParseInUtils.getSubNode(b,"activityref");var c=this.parsedModel.ownerDocument.createElement("values"),d='<value value="'+a.getAttribute("ActivityId")+'"><level name="name" value="'+a.getAttribute("ActivityId")+'" /><level name="type" value="'+a.getAttribute("ActivityType")+'" /></value>';b.setAttribute("value",a.getAttribute("ActivityId"));d=facilis.parsers.ParseInUtils.getParsedNode(d);c.appendChild(d);b.appendChild(c)}};facilis.parsers.input.Event=facilis.promote(h,"Activity")})();
(function(){function h(){this.ActivityElement_constructor();this.parseFunctions.push(this.getType);this.parseFunctions.push(this.getFormsRef);this.parseFunctions.push(this.getRoleRef);this.parseFunctions.push(this.getApiaTskEvents);this.parseFunctions.push(this.getApiaTskStates);this.parseFunctions.push(this.getTaskService);this.parseFunctions.push(this.getTaskUser);this.parseFunctions.push(this.getTaskSend);this.parseFunctions.push(this.getTaskReceive);this.parseFunctions.push(this.getTaskName);
this.parseFunctions.push(this.getApiaHighlightComments);this.parseFunctions.push(this.getTaskSchedule);this.parseFunctions.push(this.getSkipCondition);this.parseFunctions.push(this.getProEleId)}var f=facilis.extend(h,facilis.parsers.input.ActivityElement);f.getType=function(){var a=null;a=(a=this.getToParseSubNode("Implementation"))&&a.firstElementChild&&a.firstElementChild.firstElementChild?a.firstElementChild.firstElementChild.localName.split("Task")[1]:"None";if(this.parsedModel.taskType!=null)this.parsedModel.taskType=
a};f.getFormsRef=function(){if(this.parsedModel.steps!=null){var a=this.getToParseSubNode("FormsRef");if(a&&a.firstElementChild&&a.firstElementChild.nodeName!="Step"){for(var b=this.toParseNode.ownerDocument.createElement("FormsRef"),c=[],d=0;d<a.children.length;d++){var e=a.children[d].getAttribute("ProEleFrmStepId"),g=a.children[d].getAttribute("ProEleFrmOrder");c.push({order:e,frmOrder:g,form:a.children[d].cloneNode(true)})}c.sort(function(k,l){if(parseInt(k.order)==parseInt(l.order))return parseInt(k.frmOrder)-
parseInt(l.frmOrder);return parseInt(k.order)-parseInt(l.order)});e=null;for(d=d=g=0;d<c.length;d++){if(e!=c[d].order){for(var i=g+1;i<c[d].order;i++)b.appendChild(this.toParseNode.ownerDocument.createElement("Step"));g=parseInt(c[d].order);e=c[d].order;i=this.toParseNode.ownerDocument.createElement("Step");b.appendChild(i)}i.appendChild(c[d].form)}if(b.children.length>0)a=b}b=this.parsedModel.steps.length?this.parsedModel.steps[0]:{entityforms:[{id:"",name:"",readonly:"",multiple:"",condition:"",
documentation:""}],processforms:[{id:"",name:"",readonly:"",multiple:"",condition:"",documentation:""}]};this.parsedModel.steps=[];if(a)for(c=0;c<a.children.length;c++)this.parsedModel.steps.push(this.parseStep(a.children[c],b))}};f.parseStep=function(a,b){var c,d=facilis.clone(b),e=[],g=[];d.nodeName="value";for(c=0;c<a.children.length;c++){var i={};i.id=a.children[c].getAttribute("FrmId");i.name=a.children[c].getAttribute("FrmName");i.readonly=a.children[c].getAttribute("ProEleFrmReadOnly");i.multiple=
a.children[c].getAttribute("ProEleFrmMultiply");if(a.children[c].getAttribute("ProEleFrmEvalCond"))i.condition=a.children[c].getAttribute("ProEleFrmEvalCond");if(a.children[c].getAttribute("ConditionDoc"))i.documentation=a.children[c].getAttribute("ConditionDoc");a.children[c].getAttribute("FrmType")=="E"?g.push(i):e.push(i)}for(var k in d)if(k=="stepformse"||k=="entityforms"){d[k]=g;console.log("stepformse en Task")}else if(k=="stepformsp"||k=="processforms"){d[k]=e;console.log("stepformsp en Task")}return d};
f.getApiaTskPools=function(){var a=this.getParsedSubNode("groups"),b=this.getData(a),c=this.getToParseSubNode("ApiaTskPools"),d=this.parsedModel.ownerDocument.createElement("values");a.appendChild(d);if(c)for(a=0;a<c.children.length;a++){var e=b.cloneNode(true);e.nodeName="value";d.appendChild(e);facilis.parsers.ParseInUtils.getSubNode(e,"id").setAttribute("value",c.children[a].getAttribute("PoolId"));facilis.parsers.ParseInUtils.getSubNode(e,"name").setAttribute("value",c.children[a].getAttribute("PoolName"));
if(c.children[a].getAttribute("ProElePoolEvalCond")){var g=this.parsedModel.ownerDocument.createElement("values"),i=this.parsedModel.ownerDocument.createElement("value");g.appendChild(i);i.appendChild(c.children[a].firstElementChild.cloneNode(true));facilis.parsers.ParseInUtils.getSubNode(e,"condition").appendChild(g)}}};f.getApiaTskStates=function(){var a=[];if(this.parsedModel.taskstates!=null){var b=this.getToParseSubNode("ApiaTskStates");if(b)for(var c=0;c<b.children.length;c++){var d=this.parseApiaTskState(b.children[c]);
a.push(d)}}return a};f.parseApiaTskState=function(a){var b={};b.evtid=a.getAttribute("EvtId");b.clsid=a.getAttribute("EntStaId");b.evtname=a.getAttribute("EvtName");b.clsname=a.getAttribute("StaName");if(a.getAttribute("ProEleBusEntStaEvalCond")&&a.getAttribute("ProEleBusEntStaEvalCond")!=""){var c=a.getAttribute("ProEleBusEntStaEvalCond");b.condition=c}if(a.getAttribute("ConditionDoc")&&a.getAttribute("ConditionDoc")!=""){a=a.getAttribute("ConditionDoc");b.documentation=a}return b};f.getApiaTskEvents=
function(){var a=this.getToParseSubNode("ApiaEvents");if(a&&this.parsedModel.bussinessclasses!=null)this.parsedModel.bussinessclasses=this.parseEvents(a)};f.getRoleRef=function(){var a=this.getToParseSubNode("RoleRef");if(a&&this.parsedModel.role){var b=this.parsedModel.ownerDocument.createElement("values"),c=this.parsedModel.ownerDocument.createElement("value");b.appendChild(c);b=new facilis.model.Role;b.id=a.getAttribute("RoleId");b.name=a.getAttribute("RoleName");this.parsedModel.role=b}};f.getValues=
function(a){for(var b=0;b<a.children.length;b++)if(a.children[b].nodeName=="values")return a.children[b]};f.getTaskService=function(){var a=this.getToParseSubNode("TaskService");if(a&&this.parsedModel.service!=null){var b=new facilis.model.Service,c=facilis.parsers.ParseInUtils.getSubNode(a,"MessageIn"),d=facilis.parsers.ParseInUtils.getSubNode(a,"MessageOut");b.inmessageref=this.getMessage(c,new facilis.model.Inmessageref);b.outmessageref=this.getMessage(d,new facilis.model.Outmessageref);(a=facilis.parsers.ParseInUtils.getSubNode(a,
"WebServiceMapping"))&&this.parseWebServiceCatchNode(a,b.inmessageref);this.parseWebServiceThrowNode(null,b.outmessageref);this.parsedModel.service=b}};f.getTaskReceive=function(){var a=this.getToParseSubNode("TaskReceive");if(a&&this.parsedModel.receive!=null){var b=new facilis.model.Receive,c=facilis.parsers.ParseInUtils.getSubNode(a,"Message"),d=facilis.parsers.ParseInUtils.getSubNode(a,"WebServiceMapping");b.messageref=this.getMessage(c,new facilis.model.Message);d&&this.parseWebServiceCatchNode(d,
b.messageref);b.instantiate=a.getAttribute("Instantiate");this.parsedModel.receive=b}};f.getTaskSend=function(){var a=this.getToParseSubNode("TaskSend");if(a&&this.parsedModel.send!=null){var b=facilis.model.Send?new facilis.model.Send:null;b.messageref=facilis.model.User?new facilis.model.Messageref:null;var c=facilis.parsers.ParseInUtils.getSubNode(a,"Message"),d=facilis.parsers.ParseInUtils.getSubNode(a,"WebServiceMapping");d&&this.parseWebServiceCatchNode(d,b.messageref);this.parseWebServiceThrowNode(null,
b.messageref);b.messageref=this.getMessage(c,b.messageref);b.instantiate=a.getAttribute("Instantiate");this.parsedModel.send=b}};f.getTaskUser=function(){var a=this.getToParseSubNode("TaskUser");if(this.parsedModel.user!=null&&a){var b=facilis.model.User?new facilis.model.User:null,c=facilis.parsers.ParseInUtils.getSubNode(a,"MessageIn"),d=facilis.parsers.ParseInUtils.getSubNode(a,"MessageOut");b.messagein=this.getMessage(c,new facilis.model.Inmessageref);b.messageout=this.getMessage(d,new facilis.model.Outmessageref);
(a=facilis.parsers.ParseInUtils.getSubNode(a,"WebServiceMapping"))&&this.parseWebServiceCatchNode(a,b.messagein);this.parseWebServiceThrowNode(null,b.messageout);this.parsedModel.user=b}};f.getTaskManual=function(){};f.getMessage=function(a,b){if(a){b.name=a.getAttribute("Name");var c=facilis.parsers.ParseInUtils.getSubNode(a,"Properties");b.properties=this.parsePropertiesNode(c)}return null};f.getTaskName=function(){facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,"name",this.toParseNode.getAttribute("Name"));
facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,"nameChooser",this.toParseNode.getAttribute("Name"));if((TaskNode=this.getToParseSubNode("Task"))&&TaskNode.getAttribute("TskName")){var a=TaskNode.getAttribute("TskTitle")?TaskNode.getAttribute("TskTitle"):TaskNode.getAttribute("TskName"),b=TaskNode.getAttribute("TskName");facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,"name",a);facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,"tname",b);facilis.parsers.ParseInUtils.setSubNodeValue(this.parsedModel,
"nameChooser",TaskNode.getAttribute("TskName"));a='<values><value value="'+TaskNode.getAttribute("TskName")+'"><level name="id" value="'+TaskNode.getAttribute("TskId")+'" /><level name="name" value="'+b+'" /><level name="label" value="'+a+'" /></value></values>';a=facilis.parsers.ParseInUtils.getParsedNode(a);b=facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"nameChooser");b.getAttribute("value")=TaskNode.getAttribute("TskName");if(b){b.setAttribute("value",TaskNode.getAttribute("TskName"));
var c=facilis.parsers.ParseInUtils.getSubNode(b,"values");c&&c.removeNode();b.appendChild(a)}}};f.getApiaHighlightComments=function(){if(TaskNode&&this.parsedModel.highlightcomments!=null)this.parsedModel.highlightcomments=TaskNode.getAttribute("highlight_comments")};f.getTaskSchedule=function(){var a=TaskNode;if(this.parsedModel.scheduledTask!=null&&a)this.parsedModel.scheduledTask={tsk_sch_id:a.getAttribute("TskSchId"),asgn_type:a.getAttribute("AsignType"),active_tsk_id:a.getAttribute("ActiveTskId"),
active_prc_id:a.getAttribute("ActivePrcId"),active_prc_name:a.getAttribute("ActivePrcName")}};f.getSkipCondition=function(){if(TaskNode.getAttribute("SkipTskCond")&&this.parsedModel.skipcondition!=null)this.parsedModel.skipcondition=skipCondition};f.getProEleId=function(){if(this.parsedModel.proeleid!=null)this.parsedModel.proeleid=this.toParseNode.getAttribute("ProEleId")?this.toParseNode.getAttribute("ProEleId"):this.toParseNode.getAttribute("Id")};facilis.parsers.input.Task=facilis.promote(h,"ActivityElement")})();
(function(){function h(){this.Activity_constructor()}var f=facilis.extend(h,facilis.parsers.input.Activity);f.startParse=function(){this.getWorkflowProcess();this.getDocumentation();this.getProcesClasses()};f.getWorkflowProcess=function(){var a=facilis.parsers.ParseInUtils.getSubNode(this.parsedModel,"processref");if(a){facilis.parsers.ParseInUtils.setSubNodeValue(a,"name",this.toParseNode.getAttribute("Name"));facilis.parsers.ParseInUtils.getSubNode(a,"performers");facilis.parsers.ParseInUtils.getSubNode(a,
"properties");facilis.parsers.ParseInUtils.getSubNode(a,"assignments");facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"Performers");facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"Properties");facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"Assignments");this.parsePerformersNode(this.Performers,this.performers);this.parsePropertiesNode(this.Properties,this.properties);this.parseAssignmentsNode(this.Assignments,this.assignments)}this.parseParticipants(facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,
"Participants"))};f.parseParticipants=function(a){if(a)for(var b=0;b<a.children.length;b++){var c=a.children[b];facilis.parsers.ParserIn.addParticipant(c.attributes.Id.value,c.attributes.Name.value)}};f.getProcesClasses=function(){var a=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"ApiaProEvents");if(a&&this.parsedModel.bussinessclasses!=null)this.parsedModel.bussinessclasses=this.parseEvents(a)};f.parseLaneEvents=function(a){if(a&&this.parsedModel.bussinessclasses!=null)this.parsedModel.bussinessclasses=
this.parseEvents(a)};facilis.parsers.input.WorkflowProcess=facilis.promote(h,"Activity")})();
(function(){function h(){this.Line_constructor();this.parseFunctions.push(this.parseCondition);this.parseFunctions.push(this.parseType);this.parseFunctions.push(this.parseExecutionOrder)}var f=facilis.extend(h,facilis.parsers.input.Line);f.parseCondition=function(){var a=this.getToParseSubNode("Condition");if(a&&a.getAttribute("Type")&&this.parsedModel.conditiontype!=null)this.parsedModel.conditiontype=a.getAttribute("Type");if((a=facilis.parsers.ParseInUtils.getSubNode(a,"Expression"))&&a.firstElementChild&&
this.parsedModel.conditionexpression!=null)this.parsedModel.conditionexpression=a.firstElementChild.toString();a=this.toParseNode.getAttribute("ConditionDoc");if(!a){var b=facilis.parsers.ParseInUtils.getSubNode(this.toParseNode,"Object");if(!b)b=this.toParseNode;for(var c=0;c<b.children.length;c++)if(b.children[c].localName=="Documentation"&&b.children[c].firstElementChild){a=b.children[c].firstElementChild.nodeValue;break}}if(a&&this.parsedModel.conditiondocumentation!=null)this.parsedModel.conditiondocumentation=
a};f.parseType=function(){if(this.parsedModel.apiatype!=null)if(this.toParseNode.getAttribute("Type")=="L")this.parsedModel.apiatype="Loopback";else if(this.toParseNode.getAttribute("Type")=="W")this.parsedModel.apiatype="Wizard";else if(this.toParseNode.getAttribute("Type")=="N")this.parsedModel.apiatype="None"};f.parseExecutionOrder=function(){if(this.parsedModel.executionorder!=null&&this.toParseNode.getAttribute("ExecutionOrder"))this.parsedModel.executionorder=this.toParseNode.getAttribute("ExecutionOrder")};
facilis.parsers.input.Transition=facilis.promote(h,"Line")})();
